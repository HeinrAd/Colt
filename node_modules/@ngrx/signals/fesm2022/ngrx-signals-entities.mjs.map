{"version":3,"file":"ngrx-signals-entities.mjs","sources":["../../../../modules/signals/entities/src/models.ts","../../../../modules/signals/entities/src/helpers.ts","../../../../modules/signals/entities/src/updaters/add-entity.ts","../../../../modules/signals/entities/src/updaters/add-entities.ts","../../../../modules/signals/entities/src/updaters/remove-entity.ts","../../../../modules/signals/entities/src/updaters/remove-entities.ts","../../../../modules/signals/entities/src/updaters/remove-all-entities.ts","../../../../modules/signals/entities/src/updaters/set-entity.ts","../../../../modules/signals/entities/src/updaters/set-entities.ts","../../../../modules/signals/entities/src/updaters/set-all-entities.ts","../../../../modules/signals/entities/src/updaters/update-entity.ts","../../../../modules/signals/entities/src/updaters/update-entities.ts","../../../../modules/signals/entities/src/updaters/update-all-entities.ts","../../../../modules/signals/entities/src/with-entities.ts","../../../../modules/signals/entities/ngrx-signals-entities.ts"],"sourcesContent":["import { Signal } from '@angular/core';\n\nexport type EntityId = string | number;\n\nexport type EntityMap<Entity> = Record<EntityId, Entity>;\n\nexport type EntityState<Entity> = {\n  entityMap: EntityMap<Entity>;\n  ids: EntityId[];\n};\n\nexport type NamedEntityState<Entity, Collection extends string> = {\n  [K in Collection as `${K}EntityMap`]: EntityMap<Entity>;\n} & { [K in Collection as `${K}Ids`]: EntityId[] };\n\nexport type EntitySignals<Entity> = {\n  entities: Signal<Entity[]>;\n};\n\nexport type NamedEntitySignals<Entity, Collection extends string> = {\n  [K in Collection as `${K}Entities`]: Signal<Entity[]>;\n};\n\nexport type EntityIdProps<Entity> = {\n  [K in keyof Entity as Entity[K] extends EntityId ? K : never]: Entity[K];\n};\n\nexport type EntityIdKey<Entity> = keyof EntityIdProps<Entity> & string;\n\nexport type EntityPredicate<Entity> = (entity: Entity) => boolean;\n\nexport type EntityChanges<Entity> =\n  | Partial<Entity>\n  | ((entity: Entity) => Partial<Entity>);\n\nexport enum DidMutate {\n  None,\n  Entities,\n  Both,\n}\n","import {\n  DidMutate,\n  EntityChanges,\n  EntityId,\n  EntityPredicate,\n  EntityState,\n} from './models';\n\nexport function getEntityIdKey(config?: { idKey?: string }): string {\n  return config?.idKey ?? 'id';\n}\n\nexport function getEntityStateKeys(config?: { collection?: string }): {\n  entityMapKey: string;\n  idsKey: string;\n  entitiesKey: string;\n} {\n  const collection = config?.collection;\n  const entityMapKey =\n    collection === undefined ? 'entityMap' : `${collection}EntityMap`;\n  const idsKey = collection === undefined ? 'ids' : `${collection}Ids`;\n  const entitiesKey =\n    collection === undefined ? 'entities' : `${collection}Entities`;\n\n  return { entityMapKey, idsKey, entitiesKey };\n}\n\nexport function cloneEntityState(\n  state: Record<string, any>,\n  stateKeys: {\n    entityMapKey: string;\n    idsKey: string;\n  }\n): EntityState<any> {\n  return {\n    entityMap: { ...state[stateKeys.entityMapKey] },\n    ids: [...state[stateKeys.idsKey]],\n  };\n}\n\nexport function getEntityUpdaterResult(\n  state: EntityState<any>,\n  stateKeys: {\n    entityMapKey: string;\n    idsKey: string;\n  },\n  didMutate: DidMutate\n): Record<string, any> {\n  switch (didMutate) {\n    case DidMutate.Both: {\n      return {\n        [stateKeys.entityMapKey]: state.entityMap,\n        [stateKeys.idsKey]: state.ids,\n      };\n    }\n    case DidMutate.Entities: {\n      return { [stateKeys.entityMapKey]: state.entityMap };\n    }\n    default: {\n      return {};\n    }\n  }\n}\n\nexport function addEntityMutably(\n  state: EntityState<any>,\n  entity: any,\n  idKey: string\n): DidMutate {\n  const id = entity[idKey];\n\n  if (state.entityMap[id]) {\n    return DidMutate.None;\n  }\n\n  state.entityMap[id] = entity;\n  state.ids.push(id);\n\n  return DidMutate.Both;\n}\n\nexport function addEntitiesMutably(\n  state: EntityState<any>,\n  entities: any[],\n  idKey: string\n): DidMutate {\n  let didMutate = DidMutate.None;\n\n  for (const entity of entities) {\n    const result = addEntityMutably(state, entity, idKey);\n\n    if (result === DidMutate.Both) {\n      didMutate = result;\n    }\n  }\n\n  return didMutate;\n}\n\nexport function setEntityMutably(\n  state: EntityState<any>,\n  entity: any,\n  idKey: string\n): DidMutate {\n  const id = entity[idKey];\n\n  if (state.entityMap[id]) {\n    state.entityMap[id] = entity;\n    return DidMutate.Entities;\n  }\n\n  state.entityMap[id] = entity;\n  state.ids.push(id);\n\n  return DidMutate.Both;\n}\n\nexport function setEntitiesMutably(\n  state: EntityState<any>,\n  entities: any[],\n  idKey: string\n): DidMutate {\n  let didMutate = DidMutate.None;\n\n  for (const entity of entities) {\n    const result = setEntityMutably(state, entity, idKey);\n\n    if (didMutate === DidMutate.Both) {\n      continue;\n    }\n\n    didMutate = result;\n  }\n\n  return didMutate;\n}\n\nexport function removeEntitiesMutably(\n  state: EntityState<any>,\n  idsOrPredicate: EntityId[] | EntityPredicate<any>\n): DidMutate {\n  const ids = Array.isArray(idsOrPredicate)\n    ? idsOrPredicate\n    : state.ids.filter((id) => idsOrPredicate(state.entityMap[id]));\n  let didMutate = DidMutate.None;\n\n  for (const id of ids) {\n    if (state.entityMap[id]) {\n      delete state.entityMap[id];\n      didMutate = DidMutate.Both;\n    }\n  }\n\n  if (didMutate === DidMutate.Both) {\n    state.ids = state.ids.filter((id) => id in state.entityMap);\n  }\n\n  return didMutate;\n}\n\nexport function updateEntitiesMutably(\n  state: EntityState<any>,\n  idsOrPredicate: EntityId[] | EntityPredicate<any>,\n  changes: EntityChanges<any>\n): DidMutate {\n  const ids = Array.isArray(idsOrPredicate)\n    ? idsOrPredicate\n    : state.ids.filter((id) => idsOrPredicate(state.entityMap[id]));\n  let didMutate = DidMutate.None;\n\n  for (const id of ids) {\n    const entity = state.entityMap[id];\n\n    if (entity) {\n      const changesRecord =\n        typeof changes === 'function' ? changes(entity) : changes;\n      state.entityMap[id] = { ...entity, ...changesRecord };\n      didMutate = DidMutate.Entities;\n    }\n  }\n\n  return didMutate;\n}\n","import { PartialStateUpdater } from '@ngrx/signals';\nimport {\n  EntityId,\n  EntityIdKey,\n  EntityState,\n  NamedEntityState,\n} from '../models';\nimport {\n  addEntityMutably,\n  cloneEntityState,\n  getEntityIdKey,\n  getEntityStateKeys,\n  getEntityUpdaterResult,\n} from '../helpers';\n\nexport function addEntity<Entity extends { id: EntityId }>(\n  entity: Entity\n): PartialStateUpdater<EntityState<Entity>>;\nexport function addEntity<Entity, Collection extends string>(\n  entity: Entity,\n  config: { collection: Collection; idKey: EntityIdKey<Entity> }\n): PartialStateUpdater<NamedEntityState<Entity, Collection>>;\nexport function addEntity<\n  Entity extends { id: EntityId },\n  Collection extends string\n>(\n  entity: Entity,\n  config: { collection: Collection }\n): PartialStateUpdater<NamedEntityState<Entity, Collection>>;\nexport function addEntity<Entity>(\n  entity: Entity,\n  config: { idKey: EntityIdKey<Entity> }\n): PartialStateUpdater<EntityState<Entity>>;\nexport function addEntity(\n  entity: any,\n  config?: { collection?: string; idKey?: string }\n): PartialStateUpdater<EntityState<any> | NamedEntityState<any, string>> {\n  const idKey = getEntityIdKey(config);\n  const stateKeys = getEntityStateKeys(config);\n\n  return (state) => {\n    const clonedState = cloneEntityState(state, stateKeys);\n    const didMutate = addEntityMutably(clonedState, entity, idKey);\n\n    return getEntityUpdaterResult(clonedState, stateKeys, didMutate);\n  };\n}\n","import { PartialStateUpdater } from '@ngrx/signals';\nimport {\n  EntityId,\n  EntityIdKey,\n  EntityState,\n  NamedEntityState,\n} from '../models';\nimport {\n  addEntitiesMutably,\n  cloneEntityState,\n  getEntityIdKey,\n  getEntityStateKeys,\n  getEntityUpdaterResult,\n} from '../helpers';\n\nexport function addEntities<Entity extends { id: EntityId }>(\n  entities: Entity[]\n): PartialStateUpdater<EntityState<Entity>>;\nexport function addEntities<Entity, Collection extends string>(\n  entities: Entity[],\n  config: { collection: Collection; idKey: EntityIdKey<Entity> }\n): PartialStateUpdater<NamedEntityState<Entity, Collection>>;\nexport function addEntities<\n  Entity extends { id: EntityId },\n  Collection extends string\n>(\n  entities: Entity[],\n  config: { collection: Collection }\n): PartialStateUpdater<NamedEntityState<Entity, Collection>>;\nexport function addEntities<Entity>(\n  entities: Entity[],\n  config: { idKey: EntityIdKey<Entity> }\n): PartialStateUpdater<EntityState<Entity>>;\nexport function addEntities(\n  entities: any[],\n  config?: { collection?: string; idKey?: string }\n): PartialStateUpdater<EntityState<any> | NamedEntityState<any, string>> {\n  const idKey = getEntityIdKey(config);\n  const stateKeys = getEntityStateKeys(config);\n\n  return (state) => {\n    const clonedState = cloneEntityState(state, stateKeys);\n    const didMutate = addEntitiesMutably(clonedState, entities, idKey);\n\n    return getEntityUpdaterResult(clonedState, stateKeys, didMutate);\n  };\n}\n","import { PartialStateUpdater } from '@ngrx/signals';\nimport { EntityId, EntityState, NamedEntityState } from '../models';\nimport {\n  cloneEntityState,\n  getEntityStateKeys,\n  getEntityUpdaterResult,\n  removeEntitiesMutably,\n} from '../helpers';\n\nexport function removeEntity(\n  id: EntityId\n): PartialStateUpdater<EntityState<any>>;\nexport function removeEntity<Collection extends string>(\n  id: EntityId,\n  config: { collection: Collection }\n): PartialStateUpdater<NamedEntityState<any, Collection>>;\nexport function removeEntity(\n  id: EntityId,\n  config?: { collection?: string }\n): PartialStateUpdater<EntityState<any> | NamedEntityState<any, string>> {\n  const stateKeys = getEntityStateKeys(config);\n\n  return (state) => {\n    const clonedState = cloneEntityState(state, stateKeys);\n    const didMutate = removeEntitiesMutably(clonedState, [id]);\n\n    return getEntityUpdaterResult(clonedState, stateKeys, didMutate);\n  };\n}\n","import { PartialStateUpdater } from '@ngrx/signals';\nimport {\n  EntityId,\n  EntityPredicate,\n  EntityState,\n  NamedEntityState,\n} from '../models';\nimport {\n  cloneEntityState,\n  getEntityStateKeys,\n  getEntityUpdaterResult,\n  removeEntitiesMutably,\n} from '../helpers';\n\nexport function removeEntities(\n  ids: EntityId[]\n): PartialStateUpdater<EntityState<any>>;\nexport function removeEntities<Entity>(\n  predicate: EntityPredicate<Entity>\n): PartialStateUpdater<EntityState<Entity>>;\nexport function removeEntities<Collection extends string>(\n  ids: EntityId[],\n  config: { collection: Collection }\n): PartialStateUpdater<NamedEntityState<any, Collection>>;\nexport function removeEntities<\n  Collection extends string,\n  State extends NamedEntityState<any, Collection>,\n  Entity = State extends NamedEntityState<infer E, Collection> ? E : never\n>(\n  predicate: EntityPredicate<Entity>,\n  config: { collection: Collection }\n): PartialStateUpdater<State>;\nexport function removeEntities(\n  idsOrPredicate: EntityId[] | EntityPredicate<any>,\n  config?: { collection?: string }\n): PartialStateUpdater<EntityState<any> | NamedEntityState<any, string>> {\n  const stateKeys = getEntityStateKeys(config);\n\n  return (state) => {\n    const clonedState = cloneEntityState(state, stateKeys);\n    const didMutate = removeEntitiesMutably(clonedState, idsOrPredicate);\n\n    return getEntityUpdaterResult(clonedState, stateKeys, didMutate);\n  };\n}\n","import { PartialStateUpdater } from '@ngrx/signals';\nimport { EntityState, NamedEntityState } from '../models';\nimport { getEntityStateKeys } from '../helpers';\n\nexport function removeAllEntities(): PartialStateUpdater<EntityState<any>>;\nexport function removeAllEntities<Collection extends string>(config: {\n  collection: Collection;\n}): PartialStateUpdater<NamedEntityState<any, Collection>>;\nexport function removeAllEntities(config?: {\n  collection?: string;\n}): PartialStateUpdater<EntityState<any> | NamedEntityState<any, string>> {\n  const stateKeys = getEntityStateKeys(config);\n\n  return () => ({\n    [stateKeys.entityMapKey]: {},\n    [stateKeys.idsKey]: [],\n  });\n}\n","import { PartialStateUpdater } from '@ngrx/signals';\nimport {\n  EntityId,\n  EntityIdKey,\n  EntityState,\n  NamedEntityState,\n} from '../models';\nimport {\n  cloneEntityState,\n  getEntityIdKey,\n  getEntityStateKeys,\n  getEntityUpdaterResult,\n  setEntityMutably,\n} from '../helpers';\n\nexport function setEntity<Entity extends { id: EntityId }>(\n  entity: Entity\n): PartialStateUpdater<EntityState<Entity>>;\nexport function setEntity<Entity, Collection extends string>(\n  entity: Entity,\n  config: { collection: Collection; idKey: EntityIdKey<Entity> }\n): PartialStateUpdater<NamedEntityState<Entity, Collection>>;\nexport function setEntity<\n  Entity extends { id: EntityId },\n  Collection extends string\n>(\n  entity: Entity,\n  config: { collection: Collection }\n): PartialStateUpdater<NamedEntityState<Entity, Collection>>;\nexport function setEntity<Entity>(\n  entity: Entity,\n  config: { idKey: EntityIdKey<Entity> }\n): PartialStateUpdater<EntityState<Entity>>;\nexport function setEntity(\n  entity: any,\n  config?: { collection?: string; idKey?: string }\n): PartialStateUpdater<EntityState<any> | NamedEntityState<any, string>> {\n  const idKey = getEntityIdKey(config);\n  const stateKeys = getEntityStateKeys(config);\n\n  return (state) => {\n    const clonedState = cloneEntityState(state, stateKeys);\n    const didMutate = setEntityMutably(clonedState, entity, idKey);\n\n    return getEntityUpdaterResult(clonedState, stateKeys, didMutate);\n  };\n}\n","import { PartialStateUpdater } from '@ngrx/signals';\nimport {\n  EntityId,\n  EntityIdKey,\n  EntityState,\n  NamedEntityState,\n} from '../models';\nimport {\n  cloneEntityState,\n  getEntityIdKey,\n  getEntityStateKeys,\n  getEntityUpdaterResult,\n  setEntitiesMutably,\n} from '../helpers';\n\nexport function setEntities<Entity extends { id: EntityId }>(\n  entities: Entity[]\n): PartialStateUpdater<EntityState<Entity>>;\nexport function setEntities<Entity, Collection extends string>(\n  entities: Entity[],\n  config: { collection: Collection; idKey: EntityIdKey<Entity> }\n): PartialStateUpdater<NamedEntityState<Entity, Collection>>;\nexport function setEntities<\n  Entity extends { id: EntityId },\n  Collection extends string\n>(\n  entities: Entity[],\n  config: { collection: Collection }\n): PartialStateUpdater<NamedEntityState<Entity, Collection>>;\nexport function setEntities<Entity>(\n  entities: Entity[],\n  config: { idKey: EntityIdKey<Entity> }\n): PartialStateUpdater<EntityState<Entity>>;\nexport function setEntities(\n  entities: any[],\n  config?: { collection?: string; idKey?: string }\n): PartialStateUpdater<EntityState<any> | NamedEntityState<any, string>> {\n  const idKey = getEntityIdKey(config);\n  const stateKeys = getEntityStateKeys(config);\n\n  return (state) => {\n    const clonedState = cloneEntityState(state, stateKeys);\n    const didMutate = setEntitiesMutably(clonedState, entities, idKey);\n\n    return getEntityUpdaterResult(clonedState, stateKeys, didMutate);\n  };\n}\n","import { PartialStateUpdater } from '@ngrx/signals';\nimport {\n  EntityId,\n  EntityIdKey,\n  EntityState,\n  NamedEntityState,\n} from '../models';\nimport {\n  getEntityIdKey,\n  getEntityStateKeys,\n  setEntitiesMutably,\n} from '../helpers';\n\nexport function setAllEntities<Entity extends { id: EntityId }>(\n  entities: Entity[]\n): PartialStateUpdater<EntityState<Entity>>;\nexport function setAllEntities<Entity, Collection extends string>(\n  entities: Entity[],\n  config: { collection: Collection; idKey: EntityIdKey<Entity> }\n): PartialStateUpdater<NamedEntityState<Entity, Collection>>;\nexport function setAllEntities<\n  Entity extends { id: EntityId },\n  Collection extends string\n>(\n  entities: Entity[],\n  config: { collection: Collection }\n): PartialStateUpdater<NamedEntityState<Entity, Collection>>;\nexport function setAllEntities<Entity>(\n  entities: Entity[],\n  config: { idKey: EntityIdKey<Entity> }\n): PartialStateUpdater<EntityState<Entity>>;\nexport function setAllEntities(\n  entities: any[],\n  config?: { collection?: string; idKey?: string }\n): PartialStateUpdater<EntityState<any> | NamedEntityState<any, string>> {\n  const idKey = getEntityIdKey(config);\n  const stateKeys = getEntityStateKeys(config);\n\n  return () => {\n    const state: EntityState<any> = { entityMap: {}, ids: [] };\n    setEntitiesMutably(state, entities, idKey);\n\n    return {\n      [stateKeys.entityMapKey]: state.entityMap,\n      [stateKeys.idsKey]: state.ids,\n    };\n  };\n}\n","import { PartialStateUpdater } from '@ngrx/signals';\nimport {\n  EntityChanges,\n  EntityId,\n  EntityState,\n  NamedEntityState,\n} from '../models';\nimport {\n  cloneEntityState,\n  getEntityStateKeys,\n  getEntityUpdaterResult,\n  updateEntitiesMutably,\n} from '../helpers';\n\nexport function updateEntity<Entity>(update: {\n  id: EntityId;\n  changes: EntityChanges<Entity & {}>;\n}): PartialStateUpdater<EntityState<Entity>>;\nexport function updateEntity<\n  Collection extends string,\n  State extends NamedEntityState<any, Collection>,\n  Entity = State extends NamedEntityState<infer E, Collection> ? E : never\n>(\n  update: {\n    id: EntityId;\n    changes: EntityChanges<Entity & {}>;\n  },\n  config: { collection: Collection }\n): PartialStateUpdater<State>;\nexport function updateEntity(\n  update: {\n    id: EntityId;\n    changes: EntityChanges<any>;\n  },\n  config?: { collection?: string }\n): PartialStateUpdater<EntityState<any> | NamedEntityState<any, string>> {\n  const stateKeys = getEntityStateKeys(config);\n\n  return (state) => {\n    const clonedState = cloneEntityState(state, stateKeys);\n    const didMutate = updateEntitiesMutably(\n      clonedState,\n      [update.id],\n      update.changes\n    );\n\n    return getEntityUpdaterResult(clonedState, stateKeys, didMutate);\n  };\n}\n","import { PartialStateUpdater } from '@ngrx/signals';\nimport {\n  EntityChanges,\n  EntityId,\n  EntityPredicate,\n  EntityState,\n  NamedEntityState,\n} from '../models';\nimport {\n  cloneEntityState,\n  getEntityStateKeys,\n  getEntityUpdaterResult,\n  updateEntitiesMutably,\n} from '../helpers';\n\nexport function updateEntities<Entity>(update: {\n  ids: EntityId[];\n  changes: EntityChanges<Entity & {}>;\n}): PartialStateUpdater<EntityState<Entity>>;\nexport function updateEntities<Entity>(update: {\n  predicate: EntityPredicate<Entity>;\n  changes: EntityChanges<Entity & {}>;\n}): PartialStateUpdater<EntityState<Entity>>;\nexport function updateEntities<\n  Collection extends string,\n  State extends NamedEntityState<any, Collection>,\n  Entity = State extends NamedEntityState<infer E, Collection> ? E : never\n>(\n  update: {\n    ids: EntityId[];\n    changes: EntityChanges<Entity & {}>;\n  },\n  config: { collection: Collection }\n): PartialStateUpdater<State>;\nexport function updateEntities<\n  Collection extends string,\n  State extends NamedEntityState<any, Collection>,\n  Entity = State extends NamedEntityState<infer E, Collection> ? E : never\n>(\n  update: {\n    predicate: EntityPredicate<Entity>;\n    changes: EntityChanges<Entity & {}>;\n  },\n  config: { collection: Collection }\n): PartialStateUpdater<State>;\nexport function updateEntities(\n  update: ({ ids: EntityId[] } | { predicate: EntityPredicate<any> }) & {\n    changes: EntityChanges<any>;\n  },\n  config?: { collection?: string }\n): PartialStateUpdater<EntityState<any> | NamedEntityState<any, string>> {\n  const stateKeys = getEntityStateKeys(config);\n  const idsOrPredicate = 'ids' in update ? update.ids : update.predicate;\n\n  return (state) => {\n    const clonedState = cloneEntityState(state, stateKeys);\n    const didMutate = updateEntitiesMutably(\n      clonedState,\n      idsOrPredicate,\n      update.changes\n    );\n\n    return getEntityUpdaterResult(clonedState, stateKeys, didMutate);\n  };\n}\n","import { PartialStateUpdater } from '@ngrx/signals';\nimport { EntityChanges, EntityState, NamedEntityState } from '../models';\nimport {\n  cloneEntityState,\n  getEntityStateKeys,\n  getEntityUpdaterResult,\n  updateEntitiesMutably,\n} from '../helpers';\n\nexport function updateAllEntities<Entity>(\n  changes: EntityChanges<Entity & {}>\n): PartialStateUpdater<EntityState<Entity>>;\nexport function updateAllEntities<\n  Collection extends string,\n  State extends NamedEntityState<any, Collection>,\n  Entity = State extends NamedEntityState<infer E, Collection> ? E : never\n>(\n  changes: EntityChanges<Entity & {}>,\n  config: { collection: Collection }\n): PartialStateUpdater<State>;\nexport function updateAllEntities(\n  changes: EntityChanges<any>,\n  config?: { collection?: string }\n): PartialStateUpdater<EntityState<any> | NamedEntityState<any, string>> {\n  const stateKeys = getEntityStateKeys(config);\n\n  return (state) => {\n    const clonedState = cloneEntityState(state, stateKeys);\n    const didMutate = updateEntitiesMutably(\n      clonedState,\n      (state as Record<string, any>)[stateKeys.idsKey],\n      changes\n    );\n\n    return getEntityUpdaterResult(clonedState, stateKeys, didMutate);\n  };\n}\n","import { computed, Signal } from '@angular/core';\nimport {\n  SignalStoreFeature,\n  signalStoreFeature,\n  withComputed,\n  withState,\n} from '@ngrx/signals';\nimport {\n  EntityId,\n  EntityMap,\n  EntitySignals,\n  EntityState,\n  NamedEntitySignals,\n  NamedEntityState,\n} from './models';\nimport { getEntityStateKeys } from './helpers';\n\nexport function withEntities<Entity>(): SignalStoreFeature<\n  { state: {}; signals: {}; methods: {} },\n  {\n    state: EntityState<Entity>;\n    signals: EntitySignals<Entity>;\n    methods: {};\n  }\n>;\nexport function withEntities<Entity, Collection extends string>(config: {\n  entity: Entity;\n  collection: Collection;\n}): SignalStoreFeature<\n  { state: {}; signals: {}; methods: {} },\n  {\n    state: NamedEntityState<Entity, Collection>;\n    signals: NamedEntitySignals<Entity, Collection>;\n    methods: {};\n  }\n>;\nexport function withEntities<Entity>(config: {\n  entity: Entity;\n}): SignalStoreFeature<\n  { state: {}; signals: {}; methods: {} },\n  {\n    state: EntityState<Entity>;\n    signals: EntitySignals<Entity>;\n    methods: {};\n  }\n>;\nexport function withEntities<Entity>(config?: {\n  entity: Entity;\n  collection?: string;\n}): SignalStoreFeature {\n  const { entityMapKey, idsKey, entitiesKey } = getEntityStateKeys(config);\n\n  return signalStoreFeature(\n    withState({\n      [entityMapKey]: {},\n      [idsKey]: [],\n    }),\n    withComputed((store: Record<string, Signal<unknown>>) => ({\n      [entitiesKey]: computed(() => {\n        const entityMap = store[entityMapKey]() as EntityMap<Entity>;\n        const ids = store[idsKey]() as EntityId[];\n\n        return ids.map((id) => entityMap[id]);\n      }),\n    }))\n  );\n}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":"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"}