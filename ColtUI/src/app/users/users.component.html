<div>
  <p-button
    label="Mitglied hinzufÃ¼gen"
    icon="pi pi-plus"
    (click)="onCreateUser()"
  ></p-button>
</div>
<p-divider></p-divider>
<div class="grid grid-nogutter">
  <div class="col-12" *ngFor="let user of store.users(); let first = first">
    <div
      class="flex flex-column xl:flex-row xl:align-items-start p-4 gap-4"
      [ngClass]="{ 'border-top-1 surface-border': !first }"
    >
      <div
        class="flex flex-column sm:flex-row justify-content-between align-items-start flex-1 xl:align-items-start gap-4"
      >
        <!-- First Column -->
        <div
          class="col-3 flex flex-column align-items-center sm:align-items-start gap-3"
        >
          <div *ngIf="hasBirthdayToday(user)" style="color: rgb(242, 8, 242)">
            <i class="pi pi-star text-2xl"></i>
            <p style="display: inline">&nbsp; Heute Geburtstag!</p>
          </div>

          <div class="text-2xl font-bold text-900">
            {{ user.first_name }} {{ user.last_name }}
          </div>
          <div>
            <p-tag
              *ngIf="user.is_active; else inactive"
              value="Aktives Mitglied"
              severity="info"
              class="mr-2"
            ></p-tag>
            <p-tag
              *ngIf="checkAttendances(user)"
              value="Kaufberechtigt"
              severity="success"
            ></p-tag>
          </div>
          <ng-template #inactive
            ><p-tag value="Inaktiv" severity="danger"></p-tag
          ></ng-template>
          <div class="flex flex-row text-xl" *ngIf="user.departments[0]">
            <div class="font-bold mr-3">Beitrag:</div>
            <div *ngIf="!user.departments[1]">
              {{ user.departments[0].price | number : "1.2-2" }}
              <i class="pi pi-euro"></i>
            </div>
            <div *ngIf="user.departments[1]">
              {{ 20 | number : "1.2-2" }}
              <i class="pi pi-euro"></i>
            </div>
          </div>
        </div>

        <!-- Second Column -->
        <div class="col-6 flex flex-column justify-content-start text-900">
          <p class="text-2xl font-bold">Abteilungen</p>
          <div *ngFor="let department of user.departments" class="text-xl">
            - {{ department.title }}
          </div>
        </div>

        <!-- Third Column -->
        <div class="col flex flex-column align-items-start gap-3">
          <p-dropdown
            *ngIf="user.departments.length > 1"
            [options]="user.departments"
            [formControl]="selectedDepartment"
            placeholder="Abteilung wÃ¤hlen"
            optionLabel="title"
          ></p-dropdown>
          <p-button
            label="Heute anwesend"
            icon="pi pi-stopwatch"
            (click)="createAttendanceToday(user)"
          ></p-button>
          <p-button
            [styleClass]="'p-button-text'"
            label="Details"
            icon="pi pi-book"
            (click)="onDetails(user)"
          ></p-button>
        </div>
      </div>
    </div>
  </div>
</div>

<p-toast></p-toast>
